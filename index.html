<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مركز الكتاب للنشر - متجر الكتب الإلكتروني</title>
    <!-- Netlify Identity أولاً -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="books.js" defer></script>

    <style>
        /* أنماط CSS عامة */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #1a5f7a;
            --secondary-color: #57a6c2;
            --accent-color: #ff7b54;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --gray-color: #6c757d;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* أنماط رأس الصفحة */
        header {
            background-color: white;
            box-shadow: var(--box-shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .header-top {
            display: none;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.5rem;
            text-decoration: none;
        }

        .logo i {
            font-size: 1.8rem;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
        }

        nav a {
            text-decoration: none;
            color: var(--dark-color);
            font-weight: 500;
            transition: var(--transition);
            padding: 5px 0;
            position: relative;
        }

        nav a:hover,
        nav a.active {
            color: var(--primary-color);
        }

        nav a.active::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 3px;
            background-color: var(--primary-color);
            bottom: -5px;
            left: 0;
            border-radius: 2px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.3rem;
            color: var(--dark-color);
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--accent-color);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-actions button {
            padding: 8px 15px;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }

        .login-btn {
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color) !important;
        }

        .register-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .user-actions button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        /* زر القائمة للهواتف */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--primary-color);
            cursor: pointer;
            padding: 5px 10px;
        }

        /* أنماط Netlify Identity */
        #netlify-identity-widget {
            z-index: 10000 !important;
        }

        .netlify-identity-modal {
            position: fixed !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            z-index: 10001 !important;
        }

        /* أنماط قسم البطل */
        .hero {
            background: linear-gradient(135deg, rgba(26, 95, 122, 0.9), rgba(87, 166, 194, 0.9)), url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 80px 0;
            text-align: center;
            border-radius: 0 0 30px 30px;
            margin-bottom: 50px;
        }

        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 30px;
            opacity: 0.9;
        }

        .rating {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .stars {
            color: #FFD700;
            font-size: 1.5rem;
        }

        .cta-button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .cta-button:hover {
            background-color: #ff6b3d;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 123, 84, 0.3);
        }

        /* أنماط الأقسام العامة */
        section {
            padding: 60px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 40px;
            color: var(--primary-color);
            position: relative;
            padding-bottom: 15px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            width: 80px;
            height: 4px;
            background-color: var(--accent-color);
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }

        /* شريط التصفية والفرز */
        .books-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background-color: white;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .books-count {
            color: var(--gray-color);
            font-size: 0.95rem;
        }

        .sorting-container {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
        }

        .sort-label {
            color: var(--gray-color);
            font-size: 0.9rem;
        }

        .sort-dropdown {
            position: relative;
            display: inline-block;
        }

        .sort-dropdown-btn {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 8px 15px;
            font-size: 0.9rem;
            color: var(--dark-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .sort-dropdown-btn:hover {
            border-color: var(--primary-color);
        }

        .sort-dropdown-content {
            display: none;
            position: absolute;
            left: 0;
            background-color: white;
            min-width: 180px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border-radius: var(--border-radius);
            z-index: 100;
            padding: 10px 0;
        }

        .sort-dropdown-content.show {
            display: block;
        }

        .sort-option {
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
        }

        .sort-option:hover {
            background-color: rgba(26, 95, 122, 0.05);
        }

        .sort-option.active {
            background-color: rgba(26, 95, 122, 0.1);
            color: var(--primary-color);
            font-weight: 500;
        }

        .sort-option i {
            width: 20px;
            text-align: center;
        }

        /* أيقونات الفرز الصغيرة */
        .sort-icons {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sort-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 1px solid #ddd;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            color: var(--gray-color);
        }

        .sort-icon:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .sort-icon.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .view-options {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .view-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 1px solid #ddd;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .view-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .view-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* أنماط الكتب */
        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .book-card {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            position: relative;
        }

        .book-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .book-image {
            height: 280px;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .book-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* شارة الكتاب الجديد */
        .new-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--accent-color);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .out-of-stock-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #dc3545;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
        }

        .book-info {
            padding: 20px;
        }

        .book-category {
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .book-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            height: 55px;
            overflow: hidden;
            color: var(--dark-color);
        }

        .book-author {
            color: var(--gray-color);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .book-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .book-price {
            font-weight: 700;
            font-size: 1.3rem;
            color: var(--primary-color);
        }

        .add-to-cart {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .add-to-cart:hover {
            background-color: #0d4d65;
        }

        /* زر عرض المزيد */
        .load-more-container {
            text-align: center;
            margin-top: 40px;
        }

        .load-more-btn {
            background-color: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 12px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .load-more-btn:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(26, 95, 122, 0.3);
        }

        .load-more-btn.hidden {
            display: none;
        }

        /* أنماط قسم الخدمات */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .service-card {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            text-align: center;
            transition: var(--transition);
        }

        .service-card:hover {
            transform: translateY(-10px);
        }

        .service-icon {
            background-color: rgba(26, 95, 122, 0.1);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: var(--primary-color);
            font-size: 2rem;
        }

        .service-card h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        /* أنماط قسم التقييمات */
        .reviews-slider {
            display: flex;
            overflow-x: auto;
            gap: 30px;
            padding: 20px 10px 40px;
            scrollbar-width: thin;
        }

        .review-card {
            min-width: 300px;
            background-color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .reviewer-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .reviewer-name {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--dark-color);
        }

        .reviewer-location {
            color: var(--gray-color);
            font-size: 0.9rem;
        }

        /* تذييل الصفحة */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 60px 0 30px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-logo {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-about p {
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .footer-links h3,
        .footer-contact h3 {
            font-size: 1.3rem;
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 10px;
        }

        .footer-links h3::after,
        .footer-contact h3::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 3px;
            background-color: var(--accent-color);
            bottom: 0;
            right: 0;
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: white;
            padding-right: 5px;
        }

        .footer-contact p {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0.8;
        }

        .newsletter-form {
            display: flex;
            margin-top: 20px;
        }

        .newsletter-form input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: var(--border-radius) 0 0 var(--border-radius);
            font-size: 1rem;
        }

        .newsletter-form button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }

        .newsletter-form button:hover {
            background-color: #ff6b3d;
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            opacity: 0.7;
            font-size: 0.9rem;
        }

        /* إشعارات */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: white;
            color: var(--dark-color);
            padding: 15px 25px;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 15px;
            transform: translateX(150%);
            transition: transform 0.5s ease;
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-right: 5px solid #28a745;
        }

        .notification.error {
            border-right: 5px solid #dc3545;
        }

        .notification.info {
            border-right: 5px solid var(--primary-color);
        }

        .notification-icon {
            font-size: 1.5rem;
        }

        .notification.success .notification-icon {
            color: #28a745;
        }

        .notification.error .notification-icon {
            color: #dc3545;
        }

        .notification.info .notification-icon {
            color: var(--primary-color);
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .close-notification {
            background: none;
            border: none;
            color: var(--gray-color);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .search-section {
            padding: 20px 0;
            display: flex;
            justify-content: center;
            background-color: #f8f9fa;
        }

        .search-container {
            position: relative;
            width: 90%;
            max-width: 600px;
        }

        #bookSearchInput {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border-radius: 30px;
            border: 2px solid #e0e0e0;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        #bookSearchInput:focus {
            border-color: #27ae60;
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.2);
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #27ae60;
            font-size: 18px;
        }

        .search-stats {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
            text-align: center;
        }

        /* أنماط متجاوبة */
        @media (max-width: 992px) {
            .header-container {
                flex-direction: column;
                gap: 15px;
                padding: 15px 0;
            }

            nav ul {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .hero h1 {
                font-size: 2.2rem;
            }

            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }

            .books-toolbar {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .sorting-container {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 768px) {
            .header-top {
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
            }

            .mobile-menu-btn {
                display: block;
            }

            /* إخفاء القائمة العادية على الهواتف */
            nav {
                position: fixed;
                top: 0;
                right: -100%;
                width: 280px;
                height: 100vh;
                background-color: white;
                box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
                z-index: 1001;
                transition: right 0.3s ease;
                overflow-y: auto;
                padding-top: 70px;
            }

            nav.active {
                right: 0;
            }

            nav ul {
                flex-direction: column;
                padding: 0;
                margin: 0;
                width: 100%;
            }

            nav li {
                width: 100%;
                border-bottom: 1px solid #eee;
            }

            nav a {
                display: block;
                padding: 15px 20px;
                width: 100%;
                text-align: right;
            }

            nav a.active::after {
                display: none;
            }

            .nav-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 1000;
            }

            .nav-overlay.active {
                display: block;
            }

            .hero {
                padding: 60px 0;
                border-radius: 0 0 20px 20px;
            }

            .hero h1 {
                font-size: 1.8rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 20px;
            }

            .book-title {
                height: auto;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }

            .cart-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .cart-item-image {
                margin-left: 0;
                width: 100%;
                height: 150px;
            }

            .cart-item-price {
                margin-right: 0;
                text-align: right;
                width: 100%;
            }

            .sorting-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .sort-icons {
                align-self: flex-end;
            }

            .header-actions {
                width: 100%;
                justify-content: space-between;
            }

            .user-actions {
                display: flex !important;
                order: 1;
            }

            .cart-icon {
                order: 2;
            }
        }

        @media (max-width: 576px) {
            .header-actions {
                flex-direction: column;
                gap: 10px;
            }

            .user-actions {
                width: 100%;
                justify-content: center;
            }

            .books-grid {
                grid-template-columns: 1fr;
            }

            .notification {
                left: 20px;
                right: 20px;
                max-width: calc(100% - 40px);
            }

            .sort-dropdown-btn span {
                display: none;
            }

            .sort-dropdown-btn {
                padding: 8px;
            }

            .user-actions button {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>

<body>
    <!-- رأس الصفحة -->
    <header>
        <div class="container header-container">
            <!-- الجزء العلوي للهواتف -->
            <div class="header-top">
                <a href="index.html" class="logo">
                    <i class="fas fa-book-open"></i>
                    مركز الكتاب للنشر
                </a>
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <!-- الشعار (للشاشات الكبيرة) -->
            <a href="index.html" class="logo desktop-logo">
                <i class="fas fa-book-open"></i>
                مركز الكتاب للنشر
            </a>

            <!-- القائمة الرئيسية -->
            <nav id="mainNav">
                <ul>
                    <li><a href="index.html" class="active">الرئيسية</a></li>
                    <li><a href="#books">الكتب</a></li>
                    <li><a href="#services">الخدمات</a></li>
                    <li><a href="#about">من نحن</a></li>
                    <li><a href="#reviews">التقييمات</a></li>
                    <li><a href="#contact">تواصل معنا</a></li>
                    <li><a href="cart.html">عربة التسوق</a></li>
                    <li><a href="orders.html">طلباتي</a></li>
                </ul>
            </nav>

            <!-- الأزرار والأيقونات -->
            <div class="header-actions">
                <div class="cart-icon" id="cartIcon">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </div>

                <!-- أزرار تسجيل الدخول/التسجيل -->
                <div class="user-actions" id="userActions">
                    <button class="login-btn" id="loginBtn">تسجيل الدخول</button>
                    <button class="register-btn" id="registerBtn">إنشاء حساب</button>
                </div>

                <!-- الملف الشخصي للمستخدم المسجل -->
                <div class="user-profile" id="userProfile" style="display: none;">
                    <div class="user-avatar" id="userAvatar">م</div>
                    <div class="user-name" id="userName">محمد</div>
                    <button class="logout-btn" id="logoutBtn"
                        style="background: none; border: none; color: var(--primary-color); cursor: pointer;">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- طبقة التعتيم للقائمة المتنقلة -->
    <div class="nav-overlay" id="navOverlay"></div>

    <!-- منطقة الإشعارات -->
    <div id="notificationContainer"></div>

    <!-- قسم البطل -->
    <section class="hero">
        <div class="container">
            <div class="rating">
                <div class="stars">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                </div>
                <span>تقييم 4.9 من 5 (بناءً على 284 تقييم)</span>
            </div>
            <h1>مركز الكتاب للنشر</h1>
            <p>تأسس مركز الكتاب للنشر عام 1989، وهي دار مصرية متخصصة في طباعة ونشر الكتب في شتى المجالات، متخصصة في نشر
                الكتب الأكاديمية وكتب التربية الرياضية وعلوم الرياضة. كما تتشرف الدار بطباعة المصحف الشريف بجودة عالية.
            </p>
            <button class="cta-button" id="exploreBooks">
                <i class="fas fa-book"></i>
                استعرض إصداراتنا
            </button>
        </div>
    </section>

    <!-- شريط البحث -->
    <div class="search-section">
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="bookSearchInput" placeholder="ابحث باسم الكتاب أو المؤلف...">
            <div id="searchStats" class="search-stats"></div>
        </div>
    </div>

    <!-- شريط التصفية والفرز -->
    <div class="container" id="books">
        <div class="books-toolbar">
            <div class="books-count">
                عرض <span id="visibleBooks">8</span> منتج من أصل <span id="totalBooks">12</span>
            </div>

            <div class="sorting-container">
                <div class="sort-dropdown">
                    <button class="sort-dropdown-btn" id="sortDropdownBtn">
                        <i class="fas fa-sort-amount-down"></i>
                        <span id="sortDropdownText">الترتيب حسب: الافتراضي</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="sort-dropdown-content" id="sortDropdownContent">
                        <div class="sort-option active" data-sort="default">
                            <i class="fas fa-sort"></i>
                            <span>الترتيب الافتراضي</span>
                        </div>
                        <div class="sort-option" data-sort="price-asc">
                            <i class="fas fa-sort-amount-down-alt"></i>
                            <span>السعر: من الأقل للأعلى</span>
                        </div>
                        <div class="sort-option" data-sort="price-desc">
                            <i class="fas fa-sort-amount-down"></i>
                            <span>السعر: من الأعلى للأقل</span>
                        </div>
                        <div class="sort-option" data-sort="title-asc">
                            <i class="fas fa-sort-alpha-down"></i>
                            <span>الاسم: أ - ي</span>
                        </div>
                        <div class="sort-option" data-sort="title-desc">
                            <i class="fas fa-sort-alpha-down-alt"></i>
                            <span>الاسم: ي - أ</span>
                        </div>
                        <div class="sort-option" data-sort="newest">
                            <i class="fas fa-star"></i>
                            <span>الأحدث</span>
                        </div>
                        <div class="sort-option" data-sort="rating-desc">
                            <i class="fas fa-star"></i>
                            <span>الأعلى تقييماً</span>
                        </div>
                    </div>
                </div>

                <!-- أيقونات الفرز الصغيرة -->
                <div class="sort-icons">
                    <div class="sort-icon active" title="الترتيب الافتراضي" data-sort="default">
                        <i class="fas fa-sort"></i>
                    </div>
                    <div class="sort-icon" title="السعر من الأقل للأعلى" data-sort="price-asc">
                        <i class="fas fa-sort-amount-down-alt"></i>
                    </div>
                    <div class="sort-icon" title="السعر من الأعلى للأقل" data-sort="price-desc">
                        <i class="fas fa-sort-amount-down"></i>
                    </div>
                    <div class="sort-icon" title="الاسم من أ إلى ي" data-sort="title-asc">
                        <i class="fas fa-sort-alpha-down"></i>
                    </div>
                    <div class="sort-icon" title="الاسم من ي إلى أ" data-sort="title-desc">
                        <i class="fas fa-sort-alpha-down-alt"></i>
                    </div>
                    <div class="sort-icon" title="الأحدث أولاً" data-sort="newest">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="sort-icon" title="الأعلى تقييماً" data-sort="rating-desc">
                        <i class="fas fa-star"></i>
                    </div>
                </div>

                <!-- خيارات العرض -->
                <div class="view-options">
                    <div class="view-btn active" id="gridView" title="عرض شبكي">
                        <i class="fas fa-th-large"></i>
                    </div>
                    <div class="view-btn" id="listView" title="عرض قائمة">
                        <i class="fas fa-list"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- قسم الكتب -->
    <section id="books">
        <div class="container">
            <h2 class="section-title">إصداراتنا المميزة</h2>
            <div class="books-grid" id="booksGrid">
                <!-- سيتم إضافة الكتب ديناميكيًا باستخدام JavaScript -->
            </div>

            <!-- زر عرض المزيد -->
            <div class="load-more-container">
                <button class="load-more-btn" id="loadMoreBtn">
                    <i class="fas fa-arrow-down"></i>
                    عرض المزيد
                </button>
            </div>
        </div>
    </section>

    <!-- قسم الخدمات -->
    <section id="services" style="background-color: #f0f8ff;">
        <div class="container">
            <h2 class="section-title">خدماتنا المتنوعة</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-print"></i>
                    </div>
                    <h3>الطباعة والنشر</h3>
                    <p>نقدم خدمات متكاملة في الطباعة والتصميم وتوزيع الكتب بجودة عالية واحترافية.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-palette"></i>
                    </div>
                    <h3>التصميم والإخراج</h3>
                    <p>فريق التصميم لدينا يصمم أغلفة وتصميمات داخلية جذابة تلائم محتوى الكتاب.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-quran"></i>
                    </div>
                    <h3>طباعة المصحف الشريف</h3>
                    <p>نتشرف بطباعة المصحف الشريف برواية حفص عن عاصم بمقاساته المختلفة وبجودة عالية.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم التقييمات -->
    <section id="reviews">
        <div class="container">
            <h2 class="section-title">آراء عملائنا</h2>
            <div class="reviews-slider">
                <div class="review-card">
                    <div class="reviewer-info">
                        <div class="reviewer-avatar">ع</div>
                        <div>
                            <div class="reviewer-name">علي وليد</div>
                            <div class="reviewer-location">الجيزة</div>
                        </div>
                    </div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p>تجربة رائعة مع مركز الكتاب للنشر، جودة الطباعة متميزة جداً والتصميم أنيق. أنصح بالتعامل معهم لنشر
                        الكتب الأكاديمية.</p>
                </div>
                <div class="review-card">
                    <div class="reviewer-info">
                        <div class="reviewer-avatar">ع</div>
                        <div>
                            <div class="reviewer-name">عمر خالد</div>
                            <div class="reviewer-location">القاهرة</div>
                        </div>
                    </div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p>دار نشر محترفة جداً، تعاملت معهم لنشر كتابي عن التربية الرياضية وكانت النتيجة رائعة. أنصح الجميع
                        بالتعامل معهم.</p>
                </div>
                <div class="review-card">
                    <div class="reviewer-info">
                        <div class="reviewer-avatar">س</div>
                        <div>
                            <div class="reviewer-name">سارة أحمد</div>
                            <div class="reviewer-location">الإسكندرية</div>
                        </div>
                    </div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p>تجربة متميزة مع فريق العمل، متابعة ممتازة وجودة عالية في التصميم والطباعة. شكراً لمركز الكتاب
                        للنشر على احترافيتهم.</p>
                </div>
                <div class="review-card">
                    <div class="reviewer-info">
                        <div class="reviewer-avatar">م</div>
                        <div>
                            <div class="reviewer-name">محمد علي</div>
                            <div class="reviewer-location">المنصورة</div>
                        </div>
                    </div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p>اشتريت مجموعة من الكتب الأكاديمية وكتاب المصحف الشريف، الجودة كانت ممتازة وتجاوزت توقعاتي. شكراً
                        لكم.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم من نحن -->
    <section id="about" style="background-color: #f9f9f9;">
        <div class="container">
            <h2 class="section-title">من نحن</h2>
            <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                <p style="font-size: 1.2rem; margin-bottom: 20px;">
                    دار نشر مصرية متخصصة فى نشر العلوم والمعرفة وتتميز باصدارات التربية البدنية وحازت بشرف طباعة المصحف
                    الشريف برواية حفص عن عاصم بمقاساته المختلفة.
                </p>
                <p style="font-size: 1.1rem; margin-bottom: 30px;">
                    منذ عام 1989 ونحن نعمل بتفانٍ لتقديم أفضل الخدمات في مجال النشر والطباعة، مع التركيز على الجودة
                    والدقة في كل تفاصيل العمل. نفتخر بتقديم محتوى معرفي وثقافي يليق بقرائنا الكرام.
                </p>
                <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-top: 40px;">
                    <div style="text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary-color);">34+</div>
                        <div style="color: var(--gray-color);">سنة من الخبرة</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary-color);">5000+</div>
                        <div style="color: var(--gray-color);">كتاب منشور</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary-color);">10000+</div>
                        <div style="color: var(--gray-color);">عميل راضٍ</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- تذييل الصفحة -->
    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-about">
                    <div class="footer-logo">
                        <i class="fas fa-book-open"></i>
                        مركز الكتاب للنشر
                    </div>
                    <p>دار نشر مصرية رائدة منذ عام 1989، متخصصة في نشر الكتب الأكاديمية وكتب التربية الرياضية وعلوم
                        الرياضة. كما نتشرف بطباعة المصحف الشريف بجودة عالية.</p>
                    <div class="newsletter-form" netlify>
                        <input type="email" placeholder="أدخل بريدك الإلكتروني هنا ">
                        <button type="submit">إرسال</button>
                    </div>
                </div>

                <div class="footer-links">
                    <h3>روابط سريعة</h3>
                    <ul>
                        <li><a href="index.html">الرئيسية</a></li>
                        <li><a href="#books">الكتب</a></li>
                        <li><a href="#services">الخدمات</a></li>
                        <li><a href="#about">من نحن</a></li>
                        <li><a href="#reviews">التقييمات</a></li>
                        <li><a href="#contact">تواصل معنا</a></li>
                        <li><a href="cart.html">عربة التسوق</a></li>
                        <li><a href="orders.html">طلباتي</a></li>
                    </ul>
                </div>

                <div class="footer-contact">
                    <h3>تواصل معنا</h3>
                    <p><i class="fas fa-envelope"></i> Markazelkitab@gmail.com</p>
                    <p><i class="fas fa-phone"></i> +20-101-852-6963</p>
                    <p><i class="fas fa-map-marker-alt"></i> القاهرة، مصر</p>
                    <p style="margin-top: 20px;">نشر مركز الكتاب للنشر منذ 1989، خبرة وإبداع.</p>
                </div>
            </div>

            <div class="copyright">
                © 2025 مركز الكتاب للنشر. جميع الحقوق محفوظة.
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // بيانات العربة
        let cart = [];
        let currentSort = 'default';
        let booksToShow = 8;
        let booksIncrement = 4;
        let filteredBooksList = null;

        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', function () {
            console.log('DOM loaded, initializing...');

            // التحقق من تحميل بيانات الكتب
            if (typeof allBooks === 'undefined') {
                console.error('بيانات الكتب غير محملة!');
                showNotification('حدث خطأ في تحميل بيانات الكتب', 'error');
                return;
            }

            console.log(`تم تحميل ${allBooks.length} كتاب`);

            // عرض الكتب
            renderBooks();
            updateBooksCount();

            // تحميل العربة من التخزين المحلي
            if (localStorage.getItem('cart')) {
                try {
                    cart = JSON.parse(localStorage.getItem('cart'));
                    updateCartCount();
                } catch (e) {
                    console.error('خطأ في تحميل العربة:', e);
                    cart = [];
                }
            }

            // إضافة مستمعي الأحداث
            setupEventListeners();

            // استخدام event delegation لأزرار إضافة إلى السلة
            document.getElementById('booksGrid').addEventListener('click', function (e) {
                if (e.target.closest('.add-to-cart')) {
                    const button = e.target.closest('.add-to-cart');
                    const bookId = parseInt(button.getAttribute('data-id'));
                    addToCart(bookId);
                }
            });

            // تهيئة Netlify Identity
            initNetlifyIdentity();
        });

        // تهيئة Netlify Identity
        function initNetlifyIdentity() {
            console.log('Initializing Netlify Identity...');

            if (typeof netlifyIdentity === 'undefined') {
                console.warn('Netlify Identity widget not loaded');
                showNotification('نظام تسجيل الدخول غير متاح حالياً', 'error');
                return;
            }

            // تحديث واجهة المستخدم بناءً على حالة المصادقة الحالية
            updateAuthUI();

            netlifyIdentity.on('init', user => {
                console.log('Netlify Identity initialized, user:', user);
                updateAuthUI();
            });

            netlifyIdentity.on('login', user => {
                console.log('User logged in:', user);
                updateAuthUI();

                // الحصول على اسم المستخدم
                let userName = user.email.split('@')[0];
                if (user.user_metadata && user.user_metadata.full_name) {
                    userName = user.user_metadata.full_name;
                }

                showNotification(`مرحباً ${userName}! تم تسجيل دخولك بنجاح.`, 'success');
            });

            netlifyIdentity.on('logout', () => {
                console.log('User logged out');
                updateAuthUI();
                showNotification('تم تسجيل الخروج بنجاح.', 'info');
            });

            netlifyIdentity.on('error', err => {
                console.error('Netlify Identity error:', err);
                showNotification('حدث خطأ في نظام المصادقة', 'error');
            });
        }

        // تحديث واجهة المستخدم بناءً على حالة المصادقة
        function updateAuthUI() {
            console.log('Updating auth UI...');

            const userActions = document.getElementById('userActions');
            const userProfile = document.getElementById('userProfile');

            if (!userActions || !userProfile) {
                console.error('User UI elements not found');
                return;
            }

            if (typeof netlifyIdentity === 'undefined') {
                userActions.style.display = 'flex';
                userProfile.style.display = 'none';
                return;
            }

            const user = netlifyIdentity.currentUser();
            console.log('Current user:', user);

            if (user) {
                // المستخدم مسجل الدخول
                userActions.style.display = 'none';
                userProfile.style.display = 'flex';

                // تحديث اسم المستخدم والصورة
                let userName = user.email.split('@')[0];
                let userAvatar = userName.charAt(0).toUpperCase();

                if (user.user_metadata && user.user_metadata.full_name) {
                    userName = user.user_metadata.full_name;
                    userAvatar = userName.charAt(0).toUpperCase();
                }

                const userNameElement = document.getElementById('userName');
                const userAvatarElement = document.getElementById('userAvatar');

                if (userNameElement) userNameElement.textContent = userName;
                if (userAvatarElement) userAvatarElement.textContent = userAvatar;

                console.log('User logged in, showing profile:', userName);
            } else {
                // المستخدم غير مسجل الدخول
                userActions.style.display = 'flex';
                userProfile.style.display = 'none';
                console.log('User not logged in, showing login/register buttons');
            }
        }

        // فلاتر البحث
        function filterBooks() {
            const searchValue = document.getElementById('bookSearchInput').value.toLowerCase();
            const stats = document.getElementById('searchStats');

            if (searchValue.trim() === "") {
                filteredBooksList = null;
                if (stats) stats.innerText = "";
            } else {
                filteredBooksList = allBooks.filter(book =>
                    book.title.toLowerCase().includes(searchValue) ||
                    book.author.toLowerCase().includes(searchValue) ||
                    book.category.toLowerCase().includes(searchValue)
                );
                if (stats) stats.innerText = `تم العثور على ${filteredBooksList.length} نتيجة`;
            }

            renderBooks();
        }

        // استبدل دالة renderBooks() الكاملة بهذا الكود:
        function renderBooks() {
            const booksGrid = document.getElementById('booksGrid');
            if (!booksGrid) return;

            booksGrid.innerHTML = '';

            let listToRender = filteredBooksList ? [...filteredBooksList] : [...allBooks];

            // نظام الفرز المصلح
            switch (currentSort) {
                case 'price-asc':
                    listToRender.sort((a, b) => a.price - b.price);
                    break;
                case 'price-desc':
                    listToRender.sort((a, b) => b.price - a.price);
                    break;
                case 'title-asc':
                    listToRender.sort((a, b) => a.title.localeCompare(b.title, 'ar'));
                    break;
                case 'title-desc':
                    listToRender.sort((a, b) => b.title.localeCompare(a.title, 'ar'));
                    break;
                case 'newest':
                    listToRender.sort((a, b) => b.year - a.year);
                    break;
                case 'rating-desc':
                    listToRender.sort((a, b) => b.rating - a.rating);
                    break;
                default:
                    // الترتيب الافتراضي حسب الأحدث
                    listToRender.sort((a, b) => b.year - a.year);
            }

            const displayLimit = filteredBooksList ? listToRender.length : booksToShow;
            const booksToDisplay = listToRender.slice(0, displayLimit);

            if (booksToDisplay.length === 0) {
                booksGrid.innerHTML = `<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;">
            <i class="fas fa-search-minus" style="font-size: 3rem; display: block; margin-bottom: 10px;"></i>
            لا توجد كتب تطابق بحثك حالياً.
        </div>`;
                const loadMoreBtn = document.getElementById('loadMoreBtn');
                if (loadMoreBtn) loadMoreBtn.style.display = 'none';
                return;
            }

            booksToDisplay.forEach(book => {
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card';
                const ratingStars = getRatingStars(book.rating);

                // إصلاح الرابط هنا: استخدم <a> tag مباشرة
                bookCard.innerHTML = `
            <a href="book-details.html?id=${book.id}" style="text-decoration: none; color: inherit; display: block;">
                <div class="book-image">
                    <img src="${book.image}" alt="${book.title}" onerror="this.src='https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'">
                    ${book.isNew ? '<div class="new-badge">جديد</div>' : ''}
                    ${!book.inStock ? '<div class="out-of-stock-badge">نفذ من المخزون</div>' : ''}
                </div>
                <div class="book-info">
                    <div class="book-category">${book.category}</div>
                    <h3 class="book-title">${book.title}</h3>
                    <div class="book-author">${book.author}</div>
                    <div style="display: flex; align-items: center; gap: 5px; margin-bottom: 10px;">
                        <div class="stars">${ratingStars}</div>
                        <span style="color: var(--gray-color); font-size: 0.9rem;">${book.rating}</span>
                    </div>
                    <div class="book-footer">
                        <div class="book-price">${book.price} ج.م</div>
                        <button class="add-to-cart" data-id="${book.id}" ${!book.inStock ? 'disabled style="opacity: 0.5; cursor: not-allowed;"' : ''}>
                            <i class="fas fa-cart-plus"></i>
                            ${book.inStock ? 'أضف للسلة' : 'نفذ من المخزون'}
                        </button>
                    </div>
                </div>
            </a>
        `;
                booksGrid.appendChild(bookCard);
            });

            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                if (filteredBooksList || booksToShow >= allBooks.length) {
                    loadMoreBtn.style.display = 'none';
                } else {
                    loadMoreBtn.style.display = 'inline-flex';
                }
            }
        }

        // الحصول على نجوم التقييم
        function getRatingStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;

            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star"></i>';
            }

            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt"></i>';
            }

            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star"></i>';
            }

            return stars;
        }

        // تحديث عدد الكتب
        function updateBooksCount() {
            const visibleBooks = document.getElementById('visibleBooks');
            const totalBooks = document.getElementById('totalBooks');

            if (visibleBooks) {
                const displayCount = filteredBooksList ?
                    Math.min(booksToShow, filteredBooksList.length) :
                    Math.min(booksToShow, allBooks.length);
                visibleBooks.textContent = displayCount;
            }

            if (totalBooks) {
                totalBooks.textContent = filteredBooksList ? filteredBooksList.length : allBooks.length;
            }
        }

        // إضافة كتاب إلى العربة
        function addToCart(bookId) {
            console.log('Adding to cart, book ID:', bookId);

            // التحقق من تسجيل الدخول باستخدام Netlify Identity
            if (typeof netlifyIdentity === 'undefined') {
                showNotification('نظام تسجيل الدخول غير متاح حالياً', 'error');
                return;
            }

            const user = netlifyIdentity.currentUser();
            console.log('Current user for cart:', user);

            if (!user) {
                showNotification('يجب تسجيل الدخول أولاً لإضافة كتب إلى عربة التسوق', 'info');
                if (typeof netlifyIdentity !== 'undefined') {
                    netlifyIdentity.open('login');
                }
                return;
            }

            const book = allBooks.find(b => b.id === bookId);

            if (!book) {
                showNotification('الكتاب غير موجود', 'error');
                return;
            }

            if (!book.inStock) {
                showNotification('عذراً، هذا الكتاب غير متوفر في المخزون حالياً', 'error');
                return;
            }

            const existingItem = cart.find(item => item.id === bookId);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: book.id,
                    title: book.title,
                    author: book.author,
                    price: book.price,
                    image: book.image,
                    quantity: 1
                });
            }

            try {
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                showNotification(`تم إضافة "${book.title}" إلى عربة التسوق`, 'success');
            } catch (e) {
                console.error('خطأ في حفظ العربة:', e);
                showNotification('حدث خطأ أثناء إضافة المنتج للعربة', 'error');
            }
        }

        // تحديث عداد العربة
        function updateCartCount() {
            const cartCount = document.querySelector('.cart-count');
            if (cartCount) {
                const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
                cartCount.textContent = totalItems;
            }
        }

        // إظهار إشعار
        function showNotification(message, type = 'info') {
            const notificationContainer = document.getElementById('notificationContainer');
            if (!notificationContainer) return;

            // إزالة الإشعارات القديمة
            const oldNotifications = notificationContainer.querySelectorAll('.notification');
            oldNotifications.forEach(notification => {
                if (notification.parentNode === notificationContainer) {
                    notification.remove();
                }
            });

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;

            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            if (type === 'error') icon = 'exclamation-circle';

            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas fa-${icon}"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${type === 'success' ? 'تم بنجاح' : type === 'error' ? 'خطأ' : 'ملاحظة'}</div>
                    <div>${message}</div>
                </div>
                <button class="close-notification">
                    <i class="fas fa-times"></i>
                </button>
            `;

            notificationContainer.appendChild(notification);

            setTimeout(() => {
                notification.classList.add('show');
            }, 10);

            notification.querySelector('.close-notification').addEventListener('click', function () {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            });

            setTimeout(() => {
                if (notification.parentNode) {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 4000);
        }

        // تغيير الفرز - نظام مصلح
        function changeSort(sortType) {
            currentSort = sortType;
            booksToShow = 8;

            // تحديث الأيقونات النشطة
            document.querySelectorAll('.sort-icon').forEach(icon => {
                icon.classList.remove('active');
            });
            const sortIcon = document.querySelector(`.sort-icon[data-sort="${sortType}"]`);
            if (sortIcon) sortIcon.classList.add('active');

            // تحديث القائمة المنسدلة
            document.querySelectorAll('.sort-option').forEach(option => {
                option.classList.remove('active');
            });
            const sortOption = document.querySelector(`.sort-option[data-sort="${sortType}"]`);
            if (sortOption) sortOption.classList.add('active');

            // تحديث نص الزر
            const sortText = sortOption ? sortOption.querySelector('span').textContent : '';
            const sortDropdownText = document.getElementById('sortDropdownText');
            if (sortDropdownText && sortText) {
                sortDropdownText.textContent = `الترتيب حسب: ${sortText}`;
            }

            // إعادة عرض الكتب
            renderBooks();
            updateBooksCount();

            // إغلاق القائمة المنسدلة
            const sortDropdownContent = document.getElementById('sortDropdownContent');
            if (sortDropdownContent) sortDropdownContent.classList.remove('show');
        }

        // عرض المزيد من الكتب
        function loadMoreBooks() {
            booksToShow += booksIncrement;
            renderBooks();
            updateBooksCount();

            // تمرير الصفحة إلى قسم الكتب بعد تحميل المزيد
            const booksSection = document.getElementById('books');
            if (booksSection) {
                booksSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // إظهار إشعار
            showNotification('تم تحميل المزيد من الكتب', 'success');
        }

        // إعداد مستمعي الأحداث
        function setupEventListeners() {
            console.log('Setting up event listeners...');

            // زر القائمة المتنقلة للهواتف
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mainNav = document.getElementById('mainNav');
            const navOverlay = document.getElementById('navOverlay');

            if (mobileMenuBtn && mainNav) {
                mobileMenuBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    mainNav.classList.toggle('active');
                    if (navOverlay) navOverlay.classList.toggle('active');

                    // تغيير الأيقونة
                    const icon = this.querySelector('i');
                    if (mainNav.classList.contains('active')) {
                        icon.className = 'fas fa-times';
                        document.body.style.overflow = 'hidden';
                    } else {
                        icon.className = 'fas fa-bars';
                        document.body.style.overflow = '';
                    }
                });

                // إغلاق القائمة عند النقر على طبقة التعتيم
                if (navOverlay) {
                    navOverlay.addEventListener('click', function () {
                        mainNav.classList.remove('active');
                        this.classList.remove('active');
                        mobileMenuBtn.querySelector('i').className = 'fas fa-bars';
                        document.body.style.overflow = '';
                    });
                }

                // إغلاق القائمة عند النقر على رابط
                mainNav.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', function () {
                        mainNav.classList.remove('active');
                        if (navOverlay) navOverlay.classList.remove('active');
                        mobileMenuBtn.querySelector('i').className = 'fas fa-bars';
                        document.body.style.overflow = '';
                    });
                });
            }

            // أزرار تسجيل الدخول والتسجيل مع Netlify Identity
            const loginBtn = document.getElementById('loginBtn');
            if (loginBtn) {
                loginBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    console.log('Login button clicked');
                    if (typeof netlifyIdentity !== 'undefined') {
                        netlifyIdentity.open('login');
                    } else {
                        showNotification('نظام تسجيل الدخول غير متاح حالياً', 'error');
                    }
                });
            }

            const registerBtn = document.getElementById('registerBtn');
            if (registerBtn) {
                registerBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    console.log('Register button clicked');
                    if (typeof netlifyIdentity !== 'undefined') {
                        netlifyIdentity.open('signup');
                    } else {
                        showNotification('نظام التسجيل غير متاح حالياً', 'error');
                    }
                });
            }

            // زر تسجيل الخروج
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    console.log('Logout button clicked');
                    if (typeof netlifyIdentity !== 'undefined') {
                        netlifyIdentity.logout();
                    }
                });
            }

            // زر استعراض الكتب في قسم البطل
            const exploreBooksBtn = document.getElementById('exploreBooks');
            if (exploreBooksBtn) {
                exploreBooksBtn.addEventListener('click', function () {
                    const booksSection = document.getElementById('books');
                    if (booksSection) {
                        booksSection.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            }

            // أيقونة العربة
            const cartIcon = document.getElementById('cartIcon');
            if (cartIcon) {
                cartIcon.addEventListener('click', function () {
                    console.log('Cart icon clicked');
                    window.location.href = 'cart.html';
                });
            }

            // زر "عرض المزيد"
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', function () {
                    loadMoreBooks();
                });
            }

            // قائمة الفرز المنسدلة
            const sortDropdownBtn = document.getElementById('sortDropdownBtn');
            if (sortDropdownBtn) {
                sortDropdownBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    const sortDropdownContent = document.getElementById('sortDropdownContent');
                    if (sortDropdownContent) sortDropdownContent.classList.toggle('show');
                });
            }

            // خيارات الفرز في القائمة المنسدلة
            document.querySelectorAll('.sort-option').forEach(option => {
                option.addEventListener('click', function () {
                    const sortType = this.getAttribute('data-sort');
                    changeSort(sortType);
                });
            });

            // أيقونات الفرز الصغيرة
            document.querySelectorAll('.sort-icon').forEach(icon => {
                icon.addEventListener('click', function () {
                    const sortType = this.getAttribute('data-sort');
                    changeSort(sortType);
                });
            });

            // البحث أثناء الكتابة
            const bookSearchInput = document.getElementById('bookSearchInput');
            if (bookSearchInput) {
                bookSearchInput.addEventListener('input', function () {
                    filterBooks();
                });

                bookSearchInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        filterBooks();
                    }
                });
            }
        }
    </script>
</body>

</html>